sandbox:
  enabled: true
homepage:
  enabled: false
supergraph:
  listen: 0.0.0.0:4000
  introspection: true
  query_planning:
    warmed_up_queries: 5
    # experimental_paths_limit: 3000
    experimental_plans_limit: 10
    cache:
      in_memory:
        limit: 100
      redis:
        urls: ["redis://redis:6379",]
    #     ttl: 100s
include_subgraph_errors:
  all: true
plugins:
  experimental.expose_query_plan: true
health_check:
  enabled: true

experimental_query_planner_mode: legacy
#experimental_apollo_metrics_generation_mode: both


# preview_demand_control:
#   enabled: true
#   mode: measure
#   strategy:
#     static_estimated:
#       list_size: 10 
#       max: 1000 



traffic_shaping:
#   all:
#     experimental_enable_http2: false
#   subgraphs:
#     products:
#       experimental_enable_http2: true
  router:
    timeout: 20s
  all:
    timeout: 10s

#limits:
#   max_depth: 20 # Must be 15 or larger to support standard introspection query
#   max_height: 200
#   max_aliases: 2
#   max_root_fields: 20
#  http_max_request_bytes: 20000

# subscription:
telemetry:
  apollo:
    field_level_instrumentation_sampler: always_off
# #     errors:
# #       subgraph:
# #         all:
# #           redact: false
# #           send: true
  exporters:
    logging:
      stdout:
        format: text
        # rate_limit:
        #   count: 1
        #   interval: 3s

    tracing:
      common:
        service_name: "router-geal-test"
        sampler: 0.5
        #parent_based_sampler: true
        #resource: *common_resources
      # propagation:
      #    jaeger: true
      jaeger:
        enabled: true

      otlp:
        enabled: true
        protocol: grpc
        endpoint: tempo:4317
    metrics:
      otlp:
        enabled: true
        # Temporality MUST be set to delta. Failure to do this will result in incorrect metrics.
        temporality: delta
        # Optional endpoint, either 'default' or a URL (Defaults to http://127.0.0.1:4317)
        endpoint: "127.0.0.1:4317"
  

      prometheus:
        enabled: true
        path: /metrics
        listen: '0.0.0.0:9091'
      common:
        service_name: router-graphql-summit

